- name: Check a user exists
  user:
    name: "{{ user }}"
    state: present
  check_mode: true
  register: r_state

######################################################
#                                                    #
# Common boiler plate logging logic - Do not modify  #
#                                                    #
######################################################

- name: Create logging message fact
  set_fact:
    grader_output_message: "{{ inventory_hostname + ', '\
    + task_description_message }}"
  delegate_to: localhost

- when: r_state.changed
  name: Import logging tasks
  import_role:
    name: ftl_run_log_grade_to_log


######################################################
#                                                    #
# Common boiler plate logging logic - Do not modify  #
#                                                    #
######################################################

- when: success | bool
  name: Create Pass logging message
  set_fact:
    output_message: "PASS: {{ task_description_message }}"
  delegate_to: localhost

- when: not success | bool
  name: Create Fail logging message
  set_fact:
    output_message: "FAIL: {{ task_description_message }}: {{ student_error_message | d('') }}"
  delegate_to: localhost

- name: Import logging role
  import_role:
    name: ftl_run_log_grade_to_log
  vars:
    grader_output_message: "{{ output_message }}"
    success: "{{ success }}"
